<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Simple Interval Timer</title>
    <style>
      body {
        font-family: sans-serif;
        background: #111;
        color: #fff;
        text-align: center;
        padding: 50px;
      }
      h1 {
        font-size: 3rem;
      }
      .timer {
        font-size: 2.5rem;
        margin: 20px 0;
      }
      input {
        width: 60px;
        font-size: 1.2rem;
        text-align: center;
      }
      button {
        font-size: 1.2rem;
        padding: 10px 20px;
        margin-top: 20px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Interval Timer</h1>

    <div>
      Work: <input type="number" id="workTime" value="2" /> min Rest:
      <input type="number" id="restTime" value="1" /> min Rounds:
      <input type="number" id="rounds" value="3" />
    </div>

    <div class="timer" id="timerDisplay">Press Start</div>
    <div id="statusDisplay"></div>

    <button onclick="startTimer()">Start</button>
    <button onclick="resetTimer()">Reset</button>

    <script>
      let interval,
        currentRound = 0;
      let isWorking = true;
      let remaining = 0;

      function startTimer() {
        const workMinutes =
          parseInt(document.getElementById("workTime").value) || 2;
        const restMinutes =
          parseInt(document.getElementById("restTime").value) || 1;
        const totalRounds =
          parseInt(document.getElementById("rounds").value) || 3;

        currentRound = 1;
        isWorking = true;
        startPhase(workMinutes * 60, workMinutes, restMinutes, totalRounds);
      }

      function startPhase(seconds, work, rest, totalRounds) {
        clearInterval(interval);
        remaining = seconds;
        updateDisplay();

        interval = setInterval(() => {
          remaining--;
          updateDisplay();

          if (remaining <= 0) {
            clearInterval(interval);
            playBeep(); // ðŸ”Š Play beep when time is up

            setTimeout(() => {
              if (isWorking) {
                isWorking = false;
                startPhase(rest * 60, work, rest, totalRounds);
              } else {
                if (currentRound >= totalRounds) {
                  document.getElementById("timerDisplay").innerText = "Done!";
                  document.getElementById("statusDisplay").innerText = "";
                  return;
                }
                currentRound++;
                isWorking = true;
                startPhase(work * 60, work, rest, totalRounds);
              }
            }, 1000); // Wait 1 second after beep
          }
        }, 1000);
      }

      function updateDisplay() {
        const minutes = Math.floor(remaining / 60);
        const seconds = remaining % 60;
        document.getElementById("timerDisplay").innerText =
          `${minutes}:${seconds.toString().padStart(2, "0")}`;
        document.getElementById("statusDisplay").innerText =
          `Round ${currentRound} - ${isWorking ? "WORK" : "REST"}`;
      }

      function resetTimer() {
        clearInterval(interval);
        document.getElementById("timerDisplay").innerText = "Press Start";
        document.getElementById("statusDisplay").innerText = "";
      }

      function playBeep() {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();

        osc.type = "sine"; // Pure tone
        osc.frequency.setValueAtTime(800, ctx.currentTime); // Frequency in Hz
        gain.gain.setValueAtTime(0.2, ctx.currentTime); // Volume

        osc.connect(gain);
        gain.connect(ctx.destination);

        osc.start();
        osc.stop(ctx.currentTime + 1); // Beep for 1 second
      }
    </script>
  </body>
</html>
